<?xml version="1.0" encoding="UTF-8"?>
<!-- Sql Mapper -->
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="member">
	<resultMap type="memberVO" id="memberRM">
		<result property="memberGroupVO.mgroupNo" column="mgroup_no" />
		<result property="memberGroupVO.mgroupName" column="mgroup_name" />
		<result property="memberGradeVO.mgradeNo" column="mgrade_no"/>
		<result property="memberGradeVO.mgradeName" column="mgrade_name"/>
	</resultMap>
 	<insert id="registerMember" parameterType="memberVO">
 		insert into gt_member(id,password,name,address,email,birthday,mgroup_no,mgrade_no)
		values(#{id}, #{password}, #{name}, #{address}, #{email}, #{birthday}, 1, 1)
 	</insert>
 	<select id ="checkId" parameterType="string" resultMap="memberRM">
	<!-- 	기존 방식 쿼리 
	select m.id, m.password, m.name, m.address, m.email, m.birthday, m.mileage, m.total_use_mileage as totalUseMileage,
	gro.mgroup_no, gro.mgroup_name, gra.mgrade_no, gra.mgrade_name
	from gt_member m, MEMBER_GROUP gro, MEMBER_GRADE gra
	where m.mgroup_no=gro.mgroup_no
	and m.mgrade_no=gra.mgrade_no
	and m.id= #{value}  -->
	<!--  inner join 쿼리  -->
	select m.id, m.password, m.name, m.address, m.email, m.birthday, m.mileage, m.total_use_mileage as totalUseMileage,
	gro.mgroup_no, gro.mgroup_name, gra.mgrade_no, gra.mgrade_name
	from gt_member m
	inner join member_group gro on m.mgroup_no=gro.mgroup_no
	inner join member_grade gra on m.mgrade_no=gra.mgrade_no
	and m.id=#{value}
 	</select>
 	<update id="updatePassword" parameterType="memberVO">
 		update GT_MEMBER set password=#{password}
		where id=#{id}
 	</update>
 	<update id="updateMember" parameterType="memberVO">
 		update GT_MEMBER set address=#{address}, email=#{email}
		where id=#{id}
 	</update>
 	<update id="deleteMember" parameterType="string">
 		update GT_MEMBER set mgroup_no = '5'
		where id = #{value}
 	</update>
 	 <update id="addMemberMileage" parameterType="mileageTradeVO">
 		update GT_MEMBER set mileage=mileage + #{mtVolume} where id =#{memberVO.id}
 	</update>
 	<select id="readMyReviewPostList">
 		select rp_no,rp_title,rp_contents,rp_regdate 
		from review_post
		where id=#{value}
 	</select>
</mapper>